<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Electronics Flashcards – Topics</title>
  <meta name="theme-color" content="#0a77d5" />
  <link rel="icon" href="favicon.ico" sizes="any">
  <style>
    :root{
      --bg: #f6fbff; --card:#fff; --ink:#13213a; --muted:#5a6a85;
      --brand:#0a77d5; --brand-2:#0e63ad; --ring: rgba(10,119,213,.25);
      --ok:#17a34a; --bad:#e23d3d;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;color:var(--ink);background: radial-gradient(1200px 600px at 10% -20%, #e7f5ff, transparent) var(--bg);
      font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;}
    .container{max-width:1100px;margin:24px auto;padding:0 16px}
    header{ text-align:center; margin-bottom:18px; }
    header h1{ margin:0; font-size:clamp(1.25rem,2.6vw,2rem); color:var(--brand-2); }
    header .sub{ color:var(--muted); }

    .cards{ display:grid; grid-template-columns: repeat(auto-fit,minmax(260px,1fr)); gap:16px; }
    .card{ background:var(--card); border-radius:16px; padding:18px; box-shadow:0 10px 30px rgba(0,0,0,.08); }
    .card h3{ margin:0 0 8px; font-size:1.05rem; }
    .muted{ color:var(--muted); }

    .tagbar{ display:flex; flex-wrap:wrap; gap:8px; margin:10px 0 2px; }
    .tag{ padding:8px 12px; border-radius:999px; border:1px solid #d7e7f7; background:#fff; color:var(--ink); cursor:pointer; font-weight:600; }
    .tag.active{ background: linear-gradient(145deg, var(--brand), var(--brand-2)); color:#fff; border:none; }
    .tag small{ opacity:.85; margin-left:6px; }

    .btnrow{ display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin:14px 0; }
    .btn{ border:1px solid #d7e7f7; background:#fff; color:var(--ink); padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:600; }
    .btn:hover{ transform:translateY(-1px) }
    .btn:focus-visible{ box-shadow:0 0 0 4px var(--ring); outline:none; }
    .primary{ background:linear-gradient(145deg,var(--brand),var(--brand-2)); color:#fff; border:none; }
    .ghost{ background:#f3f8fe; }

    /* Quiz view */
    .quiz{ display:none; }
    .progress{ display:flex; justify-content:space-between; color:var(--muted); font-size:.95rem; margin-bottom:10px; }
    .progressbar{ height:8px; background:#eaf3fb; border-radius:999px; overflow:hidden; margin:8px 0 14px; }
    .progressbar>i{ display:block; height:100%; width:0%; background:linear-gradient(145deg,var(--brand),var(--brand-2)); transition:width .25s ease; }
    .question{ margin: 6px 0 12px; font-size: clamp(1.05rem, 2vw, 1.35rem); }
    .choices{ padding:0; margin:0 0 8px; list-style:none; display:grid; gap:10px; }
    .choice{ border:1px solid #e6eef7; border-radius:12px; padding:12px 14px; cursor:pointer; transition: transform .04s ease, box-shadow .1s ease, border-color .2s ease; background:#fff; outline:none; }
    .choice:hover{ transform:translateY(-1px) }
    .choice:focus-visible{ box-shadow:0 0 0 4px var(--ring); border-color:var(--brand); }
    .choice.correct{ border-color:rgba(23,163,74,.55); background:#f1fcf5; }
    .choice.incorrect{ border-color:rgba(226,61,61,.55); background:#fff5f5; }
    .hintrow{ display:flex; gap:10px; align-items:center; margin:8px 0 12px; }
    .hint{ color:var(--muted); background:#f7fbff; border:1px dashed #cfe8ff; border-radius:10px; padding:8px 10px; }
    .footer{ text-align:center; color:var(--muted); margin: 14px 0; font-size:.9rem; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>⚡ Electronics Flashcards — Choose Topics</h1>
      <div class="sub">Pick one or more topics, then start practicing. Keyboard in quiz: 1–4, H, N, R.</div>
    </header>

    <section class="card">
      <h3>Topics</h3>
      <div id="tagbar" class="tagbar" aria-label="Topic filter"></div>
      <div class="btnrow">
        <button id="startBtn" class="btn primary">Start studying</button>
        <button id="selectAllBtn" class="btn ghost">Select all</button>
        <button id="clearBtn" class="btn">Clear</button>
      </div>
      <p class="muted" id="selInfo">No topics selected yet.</p>
    </section>

    <section id="quiz" class="card quiz" role="region" aria-live="polite">
      <div class="progress">
        <div id="ptext">Q 1 / 1</div>
        <div id="score">Score: 0</div>
      </div>
      <div class="progressbar" aria-hidden="true"><i id="bar" style="width:0%"></i></div>
      <h2 id="question" class="question">Loading…</h2>
      <ol id="choices" class="choices" role="listbox" aria-label="Answer choices"></ol>
      <div class="hintrow">
        <button id="hintBtn" class="btn ghost" aria-controls="hintText" aria-expanded="false">Show hint (H)</button>
        <div id="hintText" class="hint" hidden>Hint goes here</div>
      </div>
      <div class="btnrow">
        <button id="nextBtn" class="btn primary">Next (N)</button>
        <button id="reviewBtn" class="btn">Review wrong (R)</button>
        <button id="restartBtn" class="btn">Restart</button>
        <button id="backBtn" class="btn">Back to topics</button>
      </div>
    </section>

    <footer class="footer">Progress & best score saved locally per topic set.</footer>
  </div>

<script>
  const KEY = "flashcards-topics-v1";
  const saved = JSON.parse(localStorage.getItem(KEY) || "{}");
  let selectedTags = new Set(saved.selectedTags || []);

  // Quiz state
  let CARDS = [];
  let FILTERED = [];
  let order = [];
  let idx = 0;
  let score = 0, best = saved.best || 0;
  let wrongBank = [];
  let reviewMode = false;
  let currentChoiceOrder = [];

  // UI refs
  const tagbar = document.getElementById('tagbar');
  const selInfo = document.getElementById('selInfo');
  const startBtn = document.getElementById('startBtn');
  const selectAllBtn = document.getElementById('selectAllBtn');
  const clearBtn = document.getElementById('clearBtn');

  const quiz = document.getElementById('quiz');
  const ptext = document.getElementById('ptext');
  const scoreEl = document.getElementById('score');
  const bar = document.getElementById('bar');
  const qEl = document.getElementById('question');
  const listEl = document.getElementById('choices');
  const hintBtn = document.getElementById('hintBtn');
  const hintText = document.getElementById('hintText');
  const nextBtn = document.getElementById('nextBtn');
  const reviewBtn = document.getElementById('reviewBtn');
  const restartBtn = document.getElementById('restartBtn');
  const backBtn = document.getElementById('backBtn');

  function persist(){
    localStorage.setItem(KEY, JSON.stringify({selectedTags: Array.from(selectedTags), best}));
  }
  function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]];} return arr; }
  function clamp(v,a,b){ return Math.max(a, Math.min(b, v)); }

  async function load(){
    let data;
    try{
      const r = await fetch('cards.json', {cache:'no-store'});
      if(!r.ok) throw new Error('no cards.json');
      data = await r.json();
    }catch(e){
      data = [
  {
    "q": "What are the three main atomic particles?",
    "choices": [
      "Proton, neutron, electron",
      "Photon, proton, ion",
      "Electron, positron, muon",
      "Quark, gluon, boson"
    ],
    "correct": 0,
    "hint": "Think basic chemistry building blocks.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Proton’s electric charge is",
    "choices": [
      "+1.6022×10^-19 C",
      "0 C",
      "-1.6022×10^-19 C",
      "+3.2×10^-19 C"
    ],
    "correct": 0,
    "hint": "Equal magnitude to electron, opposite sign.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Electron’s charge is",
    "choices": [
      "-1.6022×10^-19 C",
      "+1.6022×10^-19 C",
      "0 C",
      "-3.2×10^-19 C"
    ],
    "correct": 0,
    "hint": "Negative of the proton.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Electron’s mass (kg) in the table is",
    "choices": [
      "9.1096×10^-31",
      "1.6726×10^-27",
      "1.6726×10^-24",
      "9.11×10^-28"
    ],
    "correct": 0,
    "hint": "About 1/1836 of a proton.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Proton’s mass (kg) listed is",
    "choices": [
      "1.6726×10^-27",
      "9.1096×10^-31",
      "1.0×10^-23",
      "3.0×10^-29"
    ],
    "correct": 0,
    "hint": "Much heavier than an electron.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Neutron’s listed charge is",
    "choices": [
      "0 C",
      "+1.6022×10^-19 C",
      "-1.6022×10^-19 C",
      "+3.2×10^-19 C"
    ],
    "correct": 0,
    "hint": "Neutral by name.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Who discovered the electron?",
    "choices": [
      "J. J. Thomson",
      "Ernest Rutherford",
      "James Chadwick",
      "Niels Bohr"
    ],
    "correct": 0,
    "hint": "Cathode rays experiments.",
    "tags": [
      "Atomic structure",
      "History & discoveries"
    ]
  },
  {
    "q": "Who identified the proton (1917)?",
    "choices": [
      "Ernest Rutherford",
      "J. J. Thomson",
      "James Chadwick",
      "Robert Millikan"
    ],
    "correct": 0,
    "hint": "Gold-foil fame too.",
    "tags": [
      "Atomic structure",
      "History & discoveries"
    ]
  },
  {
    "q": "Who discovered the neutron (1932)?",
    "choices": [
      "James Chadwick",
      "Ernest Rutherford",
      "J. J. Thomson",
      "Paul Dirac"
    ],
    "correct": 0,
    "hint": "Neutral nucleus component.",
    "tags": [
      "Atomic structure",
      "History & discoveries"
    ]
  },
  {
    "q": "Where is most atomic mass located?",
    "choices": [
      "Nucleus",
      "Electron cloud",
      "Valence band",
      "Outer shell"
    ],
    "correct": 0,
    "hint": "Dense central region.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Atoms typically have equal numbers of",
    "choices": [
      "Protons and electrons",
      "Neutrons and electrons",
      "Protons and neutrons",
      "Valence and core electrons"
    ],
    "correct": 0,
    "hint": "Charge neutrality.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Adding a proton to an atom makes",
    "choices": [
      "A new element",
      "An isotope",
      "A molecule",
      "An ion"
    ],
    "correct": 0,
    "hint": "Atomic number defines element.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Adding a neutron makes",
    "choices": [
      "An isotope",
      "A new element",
      "A cation",
      "A molecule"
    ],
    "correct": 0,
    "hint": "Same element, different mass.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Valence electrons are found in the",
    "choices": [
      "Outermost shell",
      "Nucleus",
      "Innermost shell",
      "Conduction band only"
    ],
    "correct": 0,
    "hint": "They determine bonding.",
    "tags": [
      "Atomic structure",
      "Materials & conduction"
    ]
  },
  {
    "q": "Conductors typically have",
    "choices": [
      "1 valence electron",
      "4 valence electrons",
      "7–8 valence electrons",
      "No valence electrons"
    ],
    "correct": 0,
    "hint": "Copper is a model case.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Insulators usually have",
    "choices": [
      "7–8 valence electrons",
      "1 valence electron",
      "4 valence electrons",
      "2 valence electrons"
    ],
    "correct": 0,
    "hint": "Outer shell is full or nearly full.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Semiconductors like Si, Ge have",
    "choices": [
      "4 valence electrons",
      "1 valence electron",
      "8 valence electrons",
      "3 valence electrons"
    ],
    "correct": 0,
    "hint": "Between conductor and insulator.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Example of a conductor",
    "choices": [
      "Copper",
      "Rubber",
      "Glass",
      "Dry air"
    ],
    "correct": 0,
    "hint": "Used for wires.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Example of an insulator",
    "choices": [
      "Rubber",
      "Copper",
      "Germanium",
      "Silicon"
    ],
    "correct": 0,
    "hint": "Protective cable jackets.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Electrons are easy to strip because",
    "choices": [
      "They are light and small",
      "They are in nucleus",
      "They are positively charged",
      "They have no mass"
    ],
    "correct": 0,
    "hint": "Small mass, outer shells.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Vacuum tubes control the flow of",
    "choices": [
      "Electrons in vacuum",
      "Protons in gas",
      "Photons in fiber",
      "Ions in liquid"
    ],
    "correct": 0,
    "hint": "Also called electron tubes.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "Tube type that rectifies",
    "choices": [
      "Diode tube",
      "Triode",
      "Pentode",
      "Phototube"
    ],
    "correct": 0,
    "hint": "One-way current.",
    "tags": [
      "General"
    ]
  },
  {
    "q": "Tube that amplifies with grid",
    "choices": [
      "Triode",
      "Diode",
      "CRT",
      "Phototube"
    ],
    "correct": 0,
    "hint": "Control grid modulates flow.",
    "tags": [
      "General"
    ]
  },
  {
    "q": "Tetrode/Pentode add",
    "choices": [
      "More grids",
      "More plates",
      "More heaters",
      "More vacuum"
    ],
    "correct": 0,
    "hint": "Improve gain and reduce noise.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "CRT stands for",
    "choices": [
      "Cathode Ray Tube",
      "Current Relay Terminal",
      "Controlled Resistor Transducer",
      "Capacitive Ray Transceiver"
    ],
    "correct": 0,
    "hint": "Old TVs and scopes.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "CRT works by firing",
    "choices": [
      "Electron beams",
      "Proton beams",
      "Light beams",
      "Neutron beams"
    ],
    "correct": 0,
    "hint": "Onto a phosphor screen.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "Phototube’s main function",
    "choices": [
      "Detect light",
      "Amplify audio",
      "Store energy",
      "Switch AC power"
    ],
    "correct": 0,
    "hint": "Used in light meters.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "Gas discharge tubes are used in",
    "choices": [
      "Neon lights, surge protectors",
      "Microprocessors",
      "Batteries",
      "Speakers"
    ],
    "correct": 0,
    "hint": "Glow and protection.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "Tubes were replaced mainly because",
    "choices": [
      "Transistors smaller and efficient",
      "Tubes more durable",
      "Tubes cooler",
      "Transistors need glass"
    ],
    "correct": 0,
    "hint": "Size, power, reliability.",
    "tags": [
      "General"
    ]
  },
  {
    "q": "Transistor discovery era",
    "choices": [
      "1940s",
      "1920s",
      "1960s",
      "1980s"
    ],
    "correct": 0,
    "hint": "After tube dominance.",
    "tags": [
      "Semiconductor devices"
    ]
  },
  {
    "q": "Microchips integrate",
    "choices": [
      "Millions of transistors",
      "Thousands of tubes",
      "Batteries in series",
      "Relays and coils"
    ],
    "correct": 0,
    "hint": "On silicon wafer.",
    "tags": [
      "Semiconductor devices"
    ]
  },
  {
    "q": "Semiconductor conductivity can be",
    "choices": [
      "Controlled externally",
      "Fixed and unchangeable",
      "Only high",
      "Only zero"
    ],
    "correct": 0,
    "hint": "Doping, fields, light, heat.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Valence electrons affect",
    "choices": [
      "Conduction and bonding",
      "Nuclear decay",
      "Magnetic poles only",
      "Weight only"
    ],
    "correct": 0,
    "hint": "Outer shell behavior.",
    "tags": [
      "Atomic structure",
      "Materials & conduction"
    ]
  },
  {
    "q": "Which has tightly bound electrons?",
    "choices": [
      "Insulator",
      "Conductor",
      "Semiconductor",
      "Electrolyte"
    ],
    "correct": 0,
    "hint": "Hard to free carriers.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Which has many free electrons?",
    "choices": [
      "Conductor",
      "Insulator",
      "Semiconductor",
      "Dielectric only"
    ],
    "correct": 0,
    "hint": "Good for wiring.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Germanium is a",
    "choices": [
      "Semiconductor",
      "Conductor",
      "Insulator",
      "Superconductor"
    ],
    "correct": 0,
    "hint": "Group IV like silicon.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Silicon typically has",
    "choices": [
      "Four valence electrons",
      "One valence electron",
      "Seven valence electrons",
      "No valence electrons"
    ],
    "correct": 0,
    "hint": "Tetra-valent.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Atomic nucleus discovered in",
    "choices": [
      "1911",
      "1897",
      "1932",
      "1917"
    ],
    "correct": 0,
    "hint": "Rutherford’s model.",
    "tags": [
      "Atomic structure",
      "History & discoveries"
    ]
  },
  {
    "q": "Electron discovery year",
    "choices": [
      "1897",
      "1911",
      "1917",
      "1932"
    ],
    "correct": 0,
    "hint": "J. J. Thomson era.",
    "tags": [
      "Atomic structure",
      "History & discoveries"
    ]
  },
  {
    "q": "Neutron discovery year",
    "choices": [
      "1932",
      "1911",
      "1897",
      "1905"
    ],
    "correct": 0,
    "hint": "Chadwick.",
    "tags": [
      "Atomic structure",
      "History & discoveries"
    ]
  },
  {
    "q": "Early rectifiers in radios used",
    "choices": [
      "Diode tubes",
      "Phototubes",
      "Pentodes",
      "SCRs"
    ],
    "correct": 0,
    "hint": "One-way current device.",
    "tags": [
      "Circuits & applications"
    ]
  },
  {
    "q": "Triode best use historically",
    "choices": [
      "Amplification",
      "Rectification",
      "Light detection",
      "Voltage regulation"
    ],
    "correct": 0,
    "hint": "Microphones, radios.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "Pentode advantage vs triode",
    "choices": [
      "Higher gain, less noise",
      "Lower gain, more noise",
      "Uses no heater",
      "No vacuum needed"
    ],
    "correct": 0,
    "hint": "Extra grids help.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "Phototubes respond to",
    "choices": [
      "Light",
      "Sound",
      "Temperature",
      "Pressure"
    ],
    "correct": 0,
    "hint": "Photoelectric effect.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "Gas discharge tube medium",
    "choices": [
      "Gas",
      "Vacuum",
      "Solid",
      "Liquid"
    ],
    "correct": 0,
    "hint": "Ionized at voltage.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "Tubes are ancestors of",
    "choices": [
      "Modern electronics",
      "Hydraulics",
      "Optics only",
      "Biology"
    ],
    "correct": 0,
    "hint": "Pre-transistor era.",
    "tags": [
      "General"
    ]
  },
  {
    "q": "Valence electrons are important for",
    "choices": [
      "Electrical conduction",
      "Nuclear binding",
      "Gravitational pull",
      "Thermal expansion only"
    ],
    "correct": 0,
    "hint": "Outer shell activity.",
    "tags": [
      "Atomic structure",
      "Materials & conduction"
    ]
  },
  {
    "q": "Conductors example in slides",
    "choices": [
      "Copper",
      "Wood",
      "Glass",
      "Air"
    ],
    "correct": 0,
    "hint": "Metal wiring.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Insulators example in slides",
    "choices": [
      "Rubber",
      "Copper",
      "Aluminum",
      "Iron"
    ],
    "correct": 0,
    "hint": "Protective coating.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Semiconductors listed include",
    "choices": [
      "Silicon, Germanium",
      "Copper, Aluminum",
      "Rubber, Glass",
      "Air, Vacuum"
    ],
    "correct": 0,
    "hint": "Group IV elements.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Atoms are the",
    "choices": [
      "Building blocks of matter",
      "Smallest particles",
      "Same as molecules",
      "Charged carriers only"
    ],
    "correct": 0,
    "hint": "Retain element properties.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Charge neutrality means",
    "choices": [
      "Protons = electrons",
      "Neutrons = electrons",
      "Protons = neutrons always",
      "Electrons = neutrons"
    ],
    "correct": 0,
    "hint": "Balanced charges.",
    "tags": [
      "General"
    ]
  },
  {
    "q": "Isotopes differ by",
    "choices": [
      "Neutrons count",
      "Protons count",
      "Electron charge",
      "Valence only"
    ],
    "correct": 0,
    "hint": "Same element, different mass.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Early oscilloscopes used",
    "choices": [
      "CRTs",
      "LCDs",
      "LEDs",
      "Plasma"
    ],
    "correct": 0,
    "hint": "Green phosphor glow.",
    "tags": [
      "General"
    ]
  },
  {
    "q": "Neon signage uses",
    "choices": [
      "Gas discharge tubes",
      "Phototubes",
      "Triodes",
      "SCRs"
    ],
    "correct": 0,
    "hint": "Ionized gas light.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "Surge protectors can use",
    "choices": [
      "Gas discharge tubes",
      "Photodiodes",
      "Triodes",
      "Varistors only"
    ],
    "correct": 0,
    "hint": "Clamps high voltage.",
    "tags": [
      "Circuits & applications"
    ]
  },
  {
    "q": "Transistors are made from",
    "choices": [
      "Semiconductors",
      "Insulators",
      "Conductors only",
      "Vacuum"
    ],
    "correct": 0,
    "hint": "Si, Ge base.",
    "tags": [
      "Semiconductor devices"
    ]
  },
  {
    "q": "Microchips are built on",
    "choices": [
      "Silicon",
      "Glass",
      "Rubber",
      "Copper"
    ],
    "correct": 0,
    "hint": "Wafer substrate.",
    "tags": [
      "Semiconductor devices"
    ]
  },
  {
    "q": "Which tube detects light?",
    "choices": [
      "Phototube",
      "Triode",
      "Pentode",
      "Diode tube"
    ],
    "correct": 0,
    "hint": "Photoelectric device.",
    "tags": [
      "General"
    ]
  },
  {
    "q": "Which device fires electrons at phosphor?",
    "choices": [
      "CRT",
      "LED",
      "LCD",
      "Laser"
    ],
    "correct": 0,
    "hint": "Old displays.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Which tube has control grid?",
    "choices": [
      "Triode",
      "Diode",
      "Phototube",
      "CRT"
    ],
    "correct": 0,
    "hint": "Enables amplification.",
    "tags": [
      "General"
    ]
  },
  {
    "q": "Which tube is like one-way street?",
    "choices": [
      "Diode tube",
      "Triode",
      "Pentode",
      "Phototube"
    ],
    "correct": 0,
    "hint": "Rectifier.",
    "tags": [
      "General"
    ]
  },
  {
    "q": "Vacuum tube also called",
    "choices": [
      "Electron tube",
      "Light tube",
      "Photon guide",
      "Ion lamp"
    ],
    "correct": 0,
    "hint": "Historic term.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "Tubes control current in",
    "choices": [
      "Vacuum or gas",
      "Liquid",
      "Wood",
      "Plasma only"
    ],
    "correct": 0,
    "hint": "Two media mentioned.",
    "tags": [
      "General"
    ]
  },
  {
    "q": "Semiconductors allow",
    "choices": [
      "Controlled conduction",
      "Only insulation",
      "Only perfect conduction",
      "Only superconductivity"
    ],
    "correct": 0,
    "hint": "Middle behavior.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Outer electrons are called",
    "choices": [
      "Valence electrons",
      "Core electrons",
      "Free neutrons",
      "Ion cores"
    ],
    "correct": 0,
    "hint": "In the outer shell.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Copper typically has",
    "choices": [
      "One valence electron",
      "Four valence electrons",
      "Seven valence electrons",
      "No valence electrons"
    ],
    "correct": 0,
    "hint": "Group I-like behavior.",
    "tags": [
      "General"
    ]
  },
  {
    "q": "Rubber typically has",
    "choices": [
      "Seven or eight valence electrons",
      "One valence electron",
      "Four valence electrons",
      "Three valence electrons"
    ],
    "correct": 0,
    "hint": "Very poor conductor.",
    "tags": [
      "General"
    ]
  },
  {
    "q": "Silicon’s group suggests",
    "choices": [
      "Four bonds",
      "One bond",
      "Eight bonds",
      "No bonds"
    ],
    "correct": 0,
    "hint": "Tetrahedral networks.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Rutherford model emphasized",
    "choices": [
      "Nuclear center",
      "Uniform pudding",
      "String theory",
      "Quantum fields"
    ],
    "correct": 0,
    "hint": "1911 discovery.",
    "tags": [
      "History & discoveries"
    ]
  },
  {
    "q": "Thomson is tied to",
    "choices": [
      "Electron discovery",
      "Neutron discovery",
      "Proton discovery",
      "Quantum mechanics"
    ],
    "correct": 0,
    "hint": "Cathode rays.",
    "tags": [
      "History & discoveries"
    ]
  },
  {
    "q": "Chadwick is tied to",
    "choices": [
      "Neutron discovery",
      "Electron discovery",
      "Proton discovery",
      "Relativity"
    ],
    "correct": 0,
    "hint": "1932 result.",
    "tags": [
      "History & discoveries"
    ]
  },
  {
    "q": "Transistors replaced tubes because",
    "choices": [
      "Less heat and power",
      "More glass",
      "More size",
      "More heaters"
    ],
    "correct": 0,
    "hint": "Efficiency benefit.",
    "tags": [
      "Semiconductor devices"
    ]
  },
  {
    "q": "CRT still found in",
    "choices": [
      "Some oscilloscopes",
      "Modern phones",
      "OLED TVs",
      "Quantum dots only"
    ],
    "correct": 0,
    "hint": "Specialized gear.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "Phototube former use",
    "choices": [
      "Light meters",
      "Power inverters",
      "Motors",
      "Batteries"
    ],
    "correct": 0,
    "hint": "Old cameras.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "Gas discharge clamps",
    "choices": [
      "Overvoltage",
      "Overcurrent only",
      "Frequency",
      "Temperature"
    ],
    "correct": 0,
    "hint": "Surge protection.",
    "tags": [
      "Circuits & applications",
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "Valence importance in",
    "choices": [
      "Bonding and conduction",
      "Gravity",
      "Radioactivity",
      "Elasticity"
    ],
    "correct": 0,
    "hint": "Core of materials.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Semiconductors are",
    "choices": [
      "Between conductors and insulators",
      "Better than both",
      "Worse than both",
      "Same as insulators"
    ],
    "correct": 0,
    "hint": "Intermediate behavior.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Microchip birth came from",
    "choices": [
      "Integrating many transistors",
      "Integrating many tubes",
      "Stringing batteries",
      "Stacking capacitors"
    ],
    "correct": 0,
    "hint": "On silicon die.",
    "tags": [
      "Semiconductor devices"
    ]
  },
  {
    "q": "Device smaller than tube that replaced it",
    "choices": [
      "Transistor",
      "Relay",
      "SCR",
      "Varistor"
    ],
    "correct": 0,
    "hint": "Solid-state.",
    "tags": [
      "General"
    ]
  },
  {
    "q": "Valence shell term refers to",
    "choices": [
      "Outermost electron shell",
      "Innermost nucleus",
      "Proton cloud",
      "Photon field"
    ],
    "correct": 0,
    "hint": "Chemistry term.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Electrons are",
    "choices": [
      "Negative charge carriers",
      "Positive carriers",
      "Neutral carriers",
      "Ions"
    ],
    "correct": 0,
    "hint": "Flow in metals.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Protons are located in",
    "choices": [
      "Nucleus",
      "Outer shell",
      "Conduction band",
      "Vacuum"
    ],
    "correct": 0,
    "hint": "Center of atom.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Neutrons are located in",
    "choices": [
      "Nucleus",
      "Outer shell",
      "Valence ring",
      "Electron cloud"
    ],
    "correct": 0,
    "hint": "Neutral core.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Charge of proton equals",
    "choices": [
      "Magnitude of electron",
      "Twice electron",
      "Half electron",
      "Zero"
    ],
    "correct": 0,
    "hint": "Opposite sign.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Rectifier function is to",
    "choices": [
      "Convert AC to DC",
      "Convert DC to AC",
      "Amplify",
      "Store energy"
    ],
    "correct": 0,
    "hint": "One-way current action.",
    "tags": [
      "Circuits & applications"
    ]
  },
  {
    "q": "Amplifier function is to",
    "choices": [
      "Increase signal amplitude",
      "Block signals",
      "Rectify AC",
      "Detect light"
    ],
    "correct": 0,
    "hint": "Triode did this early.",
    "tags": [
      "Circuits & applications"
    ]
  },
  {
    "q": "Early TV transmitters used",
    "choices": [
      "Tetrodes/Pentodes",
      "Diode tubes",
      "Phototubes",
      "CRTs"
    ],
    "correct": 0,
    "hint": "Extra grids helped power stages.",
    "tags": [
      "General"
    ]
  },
  {
    "q": "Which device detects light but not amplify",
    "choices": [
      "Phototube",
      "Triode",
      "Op-amp",
      "Thermistor"
    ],
    "correct": 0,
    "hint": "Simple photoemission.",
    "tags": [
      "General"
    ]
  },
  {
    "q": "Which statement matches conductors?",
    "choices": [
      "Many free electrons",
      "Few free electrons",
      "Band gap is huge",
      "No electrons"
    ],
    "correct": 0,
    "hint": "Good carriers.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Which statement matches insulators?",
    "choices": [
      "Electrons tightly bound",
      "Many free electrons",
      "Easily conduct",
      "No atoms"
    ],
    "correct": 0,
    "hint": "Hard to move charges.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Which statement matches semiconductors?",
    "choices": [
      "Conductivity can be controlled",
      "Always conduct well",
      "Never conduct",
      "Only work cold"
    ],
    "correct": 0,
    "hint": "Doping, temperature matter.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Atomic building block keeps",
    "choices": [
      "Element’s properties",
      "Molecule’s properties",
      "Mixture’s properties",
      "No properties"
    ],
    "correct": 0,
    "hint": "Definition slide.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Which slide example is a conductor?",
    "choices": [
      "Copper wire",
      "Glass rod",
      "Rubber band",
      "Dry wood"
    ],
    "correct": 0,
    "hint": "Metallic bonding.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Which slide example is an insulator?",
    "choices": [
      "Rubber",
      "Copper",
      "Aluminum",
      "Iron"
    ],
    "correct": 0,
    "hint": "Cable jackets.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Tubes control flow via",
    "choices": [
      "Electrodes in vacuum/gas",
      "Magnets in liquid",
      "Belts and pulleys",
      "Heat alone"
    ],
    "correct": 0,
    "hint": "Cathode, anode, grids.",
    "tags": [
      "General"
    ]
  },
  {
    "q": "Modern electronics core is",
    "choices": [
      "Semiconductors",
      "Vacuum tubes",
      "Gears",
      "Springs"
    ],
    "correct": 0,
    "hint": "Solid-state devices.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Microchips pack",
    "choices": [
      "Millions to billions of devices",
      "Tens of tubes",
      "Only resistors",
      "Only capacitors"
    ],
    "correct": 0,
    "hint": "IC era.",
    "tags": [
      "Semiconductor devices"
    ]
  },
  {
    "q": "Electron cloud contains",
    "choices": [
      "Orbiting electrons",
      "Protons",
      "Neutrons",
      "Ions only"
    ],
    "correct": 0,
    "hint": "Outside nucleus.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "An atom with more electrons than protons",
    "choices": [
      "Anion",
      "Cation",
      "Isotope",
      "Element change"
    ],
    "correct": 0,
    "hint": "Net negative charge.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "An atom with fewer electrons than protons",
    "choices": [
      "Cation",
      "Anion",
      "Isotope",
      "Neutral atom"
    ],
    "correct": 0,
    "hint": "Net positive charge.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "One role of valence electrons",
    "choices": [
      "Determine chemical reactivity",
      "Change proton mass",
      "Set nuclear size",
      "Create photons only"
    ],
    "correct": 0,
    "hint": "Reactions and bonding.",
    "tags": [
      "Atomic structure",
      "Materials & conduction"
    ]
  },
  {
    "q": "Conduction in metals mainly via",
    "choices": [
      "Electrons",
      "Protons",
      "Neutrons",
      "Ions"
    ],
    "correct": 0,
    "hint": "Sea of electrons.",
    "tags": [
      "General"
    ]
  },
  {
    "q": "Insulators used for",
    "choices": [
      "Preventing current flow",
      "Enhancing current flow",
      "Generating electrons",
      "Detecting light"
    ],
    "correct": 0,
    "hint": "Safety and isolation.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "Semiconductors used for",
    "choices": [
      "Diodes and transistors",
      "Batteries and motors",
      "Resistors only",
      "Transformers only"
    ],
    "correct": 0,
    "hint": "Core components.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "First microchips formed by",
    "choices": [
      "Putting many transistors on silicon",
      "Stacking tubes in glass",
      "Filling gas tubes",
      "Using only resistors"
    ],
    "correct": 0,
    "hint": "Integration step.",
    "tags": [
      "Semiconductor devices"
    ]
  },
  {
    "q": "Diode tube acts as",
    "choices": [
      "One-way valve",
      "Two-way switch",
      "Amplifier",
      "Light source"
    ],
    "correct": 0,
    "hint": "Rectifies.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "Triode includes",
    "choices": [
      "Control grid",
      "Solar cell",
      "Photocathode only",
      "Gas fill only"
    ],
    "correct": 0,
    "hint": "Three electrodes.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "CRT image created by",
    "choices": [
      "Electron beam on phosphor",
      "LED array",
      "Liquid crystals",
      "Laser scanning mirrors"
    ],
    "correct": 0,
    "hint": "Phosphor glow.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "Neon glow produced by",
    "choices": [
      "Gas discharge",
      "Electron holes",
      "Nuclear decay",
      "Elastic collisions only"
    ],
    "correct": 0,
    "hint": "Ionized gas emission.",
    "tags": [
      "Vacuum tubes & CRTs"
    ]
  },
  {
    "q": "Surge protection role is to",
    "choices": [
      "Clamp high voltages",
      "Amplify signals",
      "Store energy long term",
      "Detect light"
    ],
    "correct": 0,
    "hint": "Protect equipment.",
    "tags": [
      "Circuits & applications"
    ]
  },
  {
    "q": "Which pair names a semiconductor?",
    "choices": [
      "Silicon, Germanium",
      "Rubber, Glass",
      "Copper, Iron",
      "Air, Water"
    ],
    "correct": 0,
    "hint": "Periodic table Group IV.",
    "tags": [
      "Materials & conduction"
    ]
  },
  {
    "q": "In a neutral atom, electrons equal",
    "choices": [
      "Protons",
      "Neutrons",
      "Protons+neutrons",
      "Zero"
    ],
    "correct": 0,
    "hint": "Neutral charge.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Isotope example changes",
    "choices": [
      "Neutron count",
      "Proton count",
      "Charge sign",
      "Valence only"
    ],
    "correct": 0,
    "hint": "Mass changes.",
    "tags": [
      "Atomic structure"
    ]
  },
  {
    "q": "Electron discovery used",
    "choices": [
      "Cathode rays",
      "Alpha scattering",
      "Neutron beams",
      "Gamma rays"
    ],
    "correct": 0,
    "hint": "JJ Thomson setup.",
    "tags": [
      "Atomic structure"
    ]
  }
];
    }
    // normalize tags
    CARDS = data.map(c=>({ ...c, tags: Array.isArray(c.tags)&&c.tags.length? c.tags : ['General'] }));
    buildTagbar();
    updateSelectionInfo();
  }

  function allTags(){
    const s = new Set();
    CARDS.forEach(c=> c.tags.forEach(t=> s.add(t)) );
    return Array.from(s).sort();
  }

  function buildTagbar(){
    tagbar.innerHTML = '';
    // All topics toggle
    const allBtn = document.createElement('button');
    allBtn.className = 'tag' + (selectedTags.size===0? ' active':'');
    allBtn.textContent = 'All topics';
    allBtn.addEventListener('click', ()=>{ selectedTags.clear(); updateSelectionInfo(); buildTagbar(); persist(); });
    tagbar.appendChild(allBtn);

    // counts
    const counts = {};
    CARDS.forEach(c=> c.tags.forEach(t=> counts[t]=(counts[t]||0)+1) );

    for(const t of allTags()){
      const active = selectedTags.has(t);
      const btn = document.createElement('button');
      btn.className = 'tag' + (active? ' active':'');
      btn.innerHTML = `${t} <small>${counts[t]||0}</small>`;
      btn.addEventListener('click', ()=>{
        if(active) selectedTags.delete(t); else selectedTags.add(t);
        buildTagbar(); updateSelectionInfo(); persist();
      });
      tagbar.appendChild(btn);
    }
  }

  function filteredIndices(){
    if(selectedTags.size===0) return [...Array(CARDS.length).keys()];
    const idxs=[]; CARDS.forEach((c,i)=>{ if(c.tags.some(t=>selectedTags.has(t))) idxs.push(i); });
    return idxs;
  }

  function updateSelectionInfo(){
    const idxs = filteredIndices();
    const tagList = selectedTags.size? Array.from(selectedTags).join(', ') : 'All topics';
    selInfo.textContent = `${idxs.length} cards selected · ${tagList}`;
  }

  function start(){
    FILTERED = filteredIndices();
    order = shuffle([...FILTERED]);
    idx=0; score=0; wrongBank=[]; reviewMode=false;
    document.querySelector('.cards')?.classList.add('hidden');
    quiz.style.display = 'block';
    render();
  }

  function render(){
    const seq = reviewMode ? wrongBank : order;
    if(seq.length===0){ qEl.textContent = 'No cards in this selection.'; return; }
    const total = seq.length;
    const cardIndex = seq[idx % seq.length];
    const card = CARDS[cardIndex];

    ptext.textContent = `Q ${Math.min(idx+1,total)} / ${total}`;
    bar.style.width = `${(idx/Math.max(total-1,1))*100}%`;
    scoreEl.textContent = `Score: ${score}${best? ` (Best: ${best})`:''}`;
    qEl.textContent = card.q;

    currentChoiceOrder = shuffle(card.choices.map((_,i)=>i));
    listEl.innerHTML='';
    hintText.hidden = true; hintText.textContent = card.hint || 'No hint for this card.';

    currentChoiceOrder.forEach((origIdx, pos)=>{
      const li = document.createElement('li');
      li.className = 'choice'; li.tabIndex=0; li.dataset.idxOriginal = String(origIdx);
      li.innerHTML = `<span class="index">${pos+1}.</span> ${card.choices[origIdx]}`;
      li.addEventListener('click', ()=> check(origIdx, cardIndex));
      li.addEventListener('keydown',(e)=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); check(origIdx, cardIndex);} });
      listEl.appendChild(li);
    });
  }

  function check(selectedOriginalIdx, cardIndex){
    if([...listEl.children].some(li => li.classList.contains('correct')||li.classList.contains('incorrect'))) return;
    const card = CARDS[cardIndex];
    // mark correctness based on original index
    [...listEl.children].forEach((li)=>{
      const orig = Number(li.dataset.idxOriginal);
      if(orig === card.correct) li.classList.add('correct');
      if(orig === selectedOriginalIdx && selectedOriginalIdx !== card.correct) li.classList.add('incorrect');
    });
    if(selectedOriginalIdx === card.correct) score++; else if(!wrongBank.includes(cardIndex)) wrongBank.push(cardIndex);
    if(score>best) best = score;
  }

  function next(){
    const seq = reviewMode ? wrongBank : order;
    if(seq.length===0) return;
    idx++;
    if(idx >= seq.length){ idx = 0; if(reviewMode) shuffle(wrongBank); else shuffle(order); }
    render();
  }

  function restart(){ order = shuffle([...FILTERED]); idx=0; score=0; wrongBank=[]; reviewMode=false; render(); }
  function toggleReview(){ if(wrongBank.length===0){ alert('No wrong answers yet to review.'); return; } reviewMode=!reviewMode; idx=0; score=0; render(); reviewBtn.textContent = reviewMode? 'Exit review (R)':'Review wrong (R)'; }
  function back(){ quiz.style.display='none'; updateSelectionInfo(); buildTagbar(); }

  // events
  startBtn.addEventListener('click', start);
  selectAllBtn.addEventListener('click', ()=>{ selectedTags.clear(); buildTagbar(); updateSelectionInfo(); persist(); });
  clearBtn.addEventListener('click', ()=>{ selectedTags = new Set(); buildTagbar(); updateSelectionInfo(); persist(); });

  nextBtn.addEventListener('click', next);
  restartBtn.addEventListener('click', restart);
  reviewBtn.addEventListener('click', toggleReview);
  backBtn.addEventListener('click', back);
  hintBtn.addEventListener('click', ()=>{ const open = hintText.hidden; hintText.hidden=!open; hintBtn.setAttribute('aria-expanded', String(open)); hintBtn.textContent = open? 'Hide hint (H)':'Show hint (H)'; });

  window.addEventListener('keydown', (e)=>{
    if(quiz.style.display==='block'){
      if(e.key>='1'&&e.key<='4'){
        const pos = Number(e.key)-1;
        const seq = reviewMode ? wrongBank : order;
        const cardIndex = seq.length ? seq[idx % seq.length] : order[0];
        const selectedOriginalIdx = currentChoiceOrder[pos];
        if(selectedOriginalIdx !== undefined) check(selectedOriginalIdx, cardIndex);
      }
      if(e.key.toLowerCase()==='h') hintBtn.click();
      if(e.key.toLowerCase()==='n') nextBtn.click();
      if(e.key.toLowerCase()==='r') reviewBtn.click();
    }
  });

  load();
</script>
</body>
</html>
